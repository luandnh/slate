
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Autocall API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-2ede71d7.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
    <link href="images/favicon-639cf3ec.ico" rel="icon" type="image/ico" />
  </head>

  <body class="autocall" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-4a7690d9.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-access-token" class="toc-h2 toc-link" data-title="Get Access Token">Get Access Token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#otp" class="toc-h1 toc-link" data-title="OTP">OTP</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#run-otp" class="toc-h2 toc-link" data-title="Run OTP">Run OTP</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#text-to-speech" class="toc-h1 toc-link" data-title="Text-To-Speech">Text-To-Speech</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#import-tts-voice" class="toc-h2 toc-link" data-title="Import TTS Voice">Import TTS Voice</a>
                  </li>
                  <li>
                    <a href="#run-tts" class="toc-h2 toc-link" data-title="Run TTS">Run TTS</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#call-detail-report" class="toc-h1 toc-link" data-title="Call Detail Report">Call Detail Report</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#attributes" class="toc-h2 toc-link" data-title="Attributes">Attributes</a>
                  </li>
                  <li>
                    <a href="#get-a-specific-cdr" class="toc-h2 toc-link" data-title="Get a Specific CDR">Get a Specific CDR</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><p>If any problem please contact us</p></li>
            <li><li>Email &#58; tech@tel4vn.com</li></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Xin chào! Đây là bộ API Autocall, OTP, Voice call Text-to-speech của TEL4VN.</p>

<p>Nếu bạn cần thông tin để tích hợp hoặc cần hỗ trợ vui lòng liên hệ mail: support@tel4vn.com.</p>

<p>Các thông tin như {API_HOST}, {API_KEY}, tài khoản admin, tài khoản test sẽ được bên phía Tổng đài cung cấp.</p>
<h1 id='authentication'>Authentication</h1><h2 id='get-access-token'>Get Access Token</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'http://{API_HOST}/api/v1/users/generate_access_token'</span> <span class="se">\ </span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\ </span>
<span class="nt">--data-raw</span> <span class="s1">'{ 
"secret_key": "30511f666-f888-411b-a6e0-11111fb6gg7a"
 }'</span>
</code></pre></div>
<blockquote>
<p>Response trả về:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30511f666-f888-411b-a6e0-11111fb6gg7a"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f461"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ebe8f88MzA1MTNkZjMtZjc3My00MTmY"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"expire_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">15552000</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member"</span><span class="w">
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Autocall API sử dụng API Token để xác thực truy cập tới API. API Token bạn lấy từ service thông qua {API_KEY} được Tổng đài cung cấp.</p>

<p>Tất cả các API của Autocall đều yêu cầu user cung cấp Token trong header giống phía dưới.</p>

<p><code>Authorization: Bearer {TOKEN}</code></p>

<aside class="notice">
Bạn vui lòng thay đổi <code>{TOKEN}</code> bằng token đã lấy được.
</aside>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST http://{API_HOST}/api/v1/users/generate_access_token</code></p>
<h3 id='body'>Body</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>secret_key</td>
<td>Secret key được cấp</td>
</tr>
</tbody></table>
<h1 id='otp'>OTP</h1><h2 id='run-otp'>Run OTP</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'http://{API_HOST}/api/v2/campaigns/1/otp'</span> <span class="se">\ </span>
<span class="nt">--header</span> <span class="s1">'Authorization: 1ebe8f88MzA1MTNkZjMtZjc3My00MTmY'</span> <span class="se">\ </span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\ </span>
<span class="nt">--data-raw</span> <span class="s1">'{ 
    "caller": "0123456789", 
    "callees": [ "0987654321" ], 
    "params": { 
    "template_name": "template_otp_1", 
    "code_otp": "M43TUI" 
  }, 
  "callback_url": "https://demo.webhook.com", 
  "callback_apikey": "api_key_123" 
}'</span>
</code></pre></div>
<blockquote>
<p>Response trả về:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"fail"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"1234567890"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wrong Format"</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w"> 
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
      </span><span class="s2">"1_1_1_5_cb76e372-b798-4a88-9c8a-410740f0300d_0987654321"</span><span class="w"> 
      </span><span class="p">]</span><span class="w"> 
    </span><span class="p">}</span><span class="w"> 
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>API thực hiện cuộc gọi OTP</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET http://{API_HOST}/api/v2/campaigns/{campaignId}/otp</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaignId</td>
<td>Campaign Id được cấp</td>
</tr>
</tbody></table>
<h3 id='body-2'>Body</h3>
<blockquote>
<p>Sample data:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nl">"caller"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0123456789"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"callees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
    </span><span class="s2">"0987654321"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"1234567890"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"template_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"template_otp_1"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"code_otp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M43TUI"</span><span class="w"> 
  </span><span class="p">},</span><span class="w"> 
  </span><span class="nl">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.webhook.com"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"callback_apikey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"api_key_123"</span><span class="w"> 
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>caller</td>
<td>Domain Url mà tổng đài sẽ hook dữ liệu tới</td>
</tr>
<tr>
<td>callees</td>
<td>Số điện thoại nhận cuộc gọi</td>
</tr>
<tr>
<td>params</td>
<td></td>
</tr>
<tr>
<td>params.template_name</td>
<td>Kịch bản đọc code OTP</td>
</tr>
<tr>
<td>params.code_otp</td>
<td>Code OTP</td>
</tr>
<tr>
<td>callback_url</td>
<td>SIP Call Event</td>
</tr>
<tr>
<td>callback_apikey</td>
<td>API Key của webhook (optional)</td>
</tr>
</tbody></table>
<h1 id='text-to-speech'>Text-To-Speech</h1><h2 id='import-tts-voice'>Import TTS Voice</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'http://{API_HOST}/api/v2/campaigns/1/voice/import'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Authorization: 1ebe8f88MzA1MTNkZjMtZjc3My00MTmY'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
<span class="nt">--data-raw</span> <span class="s1">'{
    "name": "thong_bao_no_cuoc_01",
    "content": "Chào bạn {{customer_name}} vui lòng thanh toán khoản nợ {{due_amount}} trước ngày {{due_date}}"
}'</span>
</code></pre></div>
<blockquote>
<p>Response trả về:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"fail"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"1234567890"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wrong Format"</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w"> 
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
      </span><span class="s2">"1_1_1_5_cb76e372-b798-4a88-9c8a-410740f0300d_0987654321"</span><span class="w"> 
      </span><span class="p">]</span><span class="w"> 
    </span><span class="p">}</span><span class="w"> 
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Tạo kịch bản Text-To-Speech</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET http://{API_HOST}/api/v2/campaigns/{campaignId}/voice/import</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaignId</td>
<td>Campaign Id được cấp</td>
</tr>
</tbody></table>
<h3 id='body-3'>Body</h3>
<blockquote>
<p>Sample data:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thong_bao_no_cuoc_01"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chào bạn {{key_field_1}} vui lòng thanh toán khoản nợ {{key_field_2}} trước ngày {{key_field_3}}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Tên kịch bản muốn tạo. (Phải là duy nhất)</td>
</tr>
<tr>
<td>content</td>
<td>Nội dung của kịch bản</td>
</tr>
<tr>
<td>key_field_1,2,3</td>
<td>Các từ khoả trong kịch bản</td>
</tr>
</tbody></table>

<p>key_field: tương ứng với đoạn text import vào campaign người dùng định nghĩa.</p>

<p>Ví dụ:
<ul>
    <li>key_field_1 là {{customer_name}}</li>
    <li>key_field_2 là {{due_amount}}</li>
    <li>key_field_3 là {{due_date}}</li>
</ul></p>

<p>Đoạn content sẽ là : &quot;Chào bạn {{customer_name}} vui lòng thanh toán khoản nợ {{due_amount}} trước ngày {{due_date}}&quot;</p>
<h2 id='run-tts'>Run TTS</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'http://{API_HOST}/api/v2/campaigns/1/voice/import'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Authorization: 1ebe8f88MzA1MTNkZjMtZjc3My00MTmY'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
<span class="nt">--data-raw</span> <span class="s1">'{
    "caller": "1234567890",
    "callees": [
        "0987654321",
        "1234567890"
    ],
    "params": {
        "template_name": "thong_bao_no_cuoc_1",
        "customer_name": "Nguyễn Văn A",
        "due_amount": "10.410.000",
        "due_days": "#15"
    },
    "callback_url": "https://demo.webhook.com",
    "callback_apikey": "api_key_123"
}
</span></code></pre></div>
<blockquote>
<p>Response trả về:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
</span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"fail"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
      </span><span class="nl">"1234567890"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wrong Format"</span><span class="w"> 
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> 
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
      </span><span class="s2">"1_1_1_5_cb76e372-b798-4a88-9c8a-410740f0300d_0987654321"</span><span class="w"> 
      </span><span class="p">]</span><span class="w"> 
    </span><span class="p">}</span><span class="w"> 
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p>API thực hiện cuộc gọi Text-To-Speech</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET http://{API_HOST}/api/v2/campaigns/{campaignId}/voice</code></p>
<h3 id='url-parameters-3'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaignId</td>
<td>Campaign Id được cấp</td>
</tr>
</tbody></table>
<h3 id='body-4'>Body</h3>
<blockquote>
<p>Sample data:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"caller"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567890"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"callees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"0987654321"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"1234567890"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"template_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thong_bao_no_cuoc_1"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"customer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nguyễn Văn A"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"due_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.410.000"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"due_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30/1/2021"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.webhook.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"callback_apikey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"api_key_123"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>caller</td>
<td>Domain Url mà tổng đài sẽ hook dữ liệu tới</td>
</tr>
<tr>
<td>callees</td>
<td>Số điện thoại nhận cuộc gọi</td>
</tr>
<tr>
<td>params</td>
<td></td>
</tr>
<tr>
<td>params.template_name</td>
<td>Kịch bản đọc code OTP</td>
</tr>
<tr>
<td>params.customer_name</td>
<td>Các thông tin sẽ được đọc dựa vào từ khoá bạn đã tạo trong kịch bản</td>
</tr>
<tr>
<td>callback_url</td>
<td>SIP Call Event</td>
</tr>
<tr>
<td>callback_apikey</td>
<td>API Key của webhook (optional)</td>
</tr>
</tbody></table>

<p>Một số lưu ý:
<ul>
  <li>Nếu muốn đọc đúng khoản tiền (Không đọc từng số) - truyền dữ liệu theo format: “10.410.000”</li>
  <li>Nếu muốn đọc từng số (Ví dụ số điện thoại) - truyền dữ liệu theo format: 123456789 hoặc “0987654321”</li>
  <li>Nếu muốn đọc thành số (Ví dụ 15 - mười lăm) - truyền dữ liệu theo format: “#15”</li>
  <li>Nếu giá trị của key field là ngày tháng năm - Yêu cầu format “dd/mm/yyyy”, ví dụ: “30/01/2021”</li>
</ul></p>

<p>params.key_field: tương ứng với đoạn text import vào campaign người dùng đã định nghĩa.</p>

<p>Ví dụ:
<ul>
  <li>Kịch bản : &quot;Chào bạn {{customer_name}} vui lòng thanh toán khoản nợ {{due_amount}} trước ngày {{due_date}}&quot;</li>
  <li>Nội dung kịch bản sẽ là: “Chào bạn Nguyễn Văn A vui lòng thanh toán khoản nợ mười triệu bốn trăm mười nghìn trước ngày ba mươi tháng một năm hai không hai mươi mốt”</li>
</ul></p>
<h1 id='call-detail-report'>Call Detail Report</h1>
<p>Lịch sử cuộc gọi</p>
<h2 id='attributes'>Attributes</h2>
<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Call Id</td>
<td>string</td>
</tr>
<tr>
<td>campaign_id</td>
<td>Campaign Id</td>
<td>string</td>
</tr>
<tr>
<td>code_otp</td>
<td>Code OTP - Null with failed calls</td>
<td>object</td>
</tr>
<tr>
<td>created_at</td>
<td>Initiate the call at</td>
<td>datetime</td>
</tr>
<tr>
<td>started_at</td>
<td>The time that callee has picked up call</td>
<td>datetime</td>
</tr>
<tr>
<td>ended_at</td>
<td>The time that callee has hang up call</td>
<td>datetime</td>
</tr>
<tr>
<td>duration</td>
<td>Call duration</td>
<td>int</td>
</tr>
<tr>
<td>keypress</td>
<td>Keypress. Default: 127 - Hangup</td>
<td>string</td>
</tr>
<tr>
<td>phone_number</td>
<td>Phone numbers was received</td>
<td>string</td>
</tr>
<tr>
<td>user_id</td>
<td>User Id</td>
<td>string</td>
</tr>
<tr>
<td>param</td>
<td>Param that api call is received</td>
<td>string</td>
</tr>
<tr>
<td>type</td>
<td>Call Type: OTP,TTS,DEFAULT</td>
<td>string</td>
</tr>
<tr>
<td>status</td>
<td>Call Disposition.</td>
<td>string</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Call Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FAIL</td>
<td>Mã lỗi mặc định</td>
</tr>
<tr>
<td>ANSWERED</td>
<td>Cuộc gọi thành công và được người dùng nhấc máy</td>
</tr>
<tr>
<td>NOANWSER</td>
<td>Người dùng gác máy hoặc không nhấc máy</td>
</tr>
<tr>
<td>BUSY</td>
<td>Cuộc gọi bị báo bận</td>
</tr>
<tr>
<td>CONGESTION</td>
<td>Cuộc gọi bị nghẽn</td>
</tr>
<tr>
<td>INVALIDNUMBER</td>
<td>Số điện thoại gọi ra không phù hợp</td>
</tr>
<tr>
<td>ERROR</td>
<td>Máy chủ nhận được yêu cầu không khớp với bất kỳ hộp thoại hoặc giao dịch nào.</td>
</tr>
<tr>
<td>CANCEL</td>
<td>Người dùng gác máy (Trường hợp riêng của nhà mạng Mobiphone gọi Mobiphone)</td>
</tr>
</tbody></table>
<h2 id='get-a-specific-cdr'>Get a Specific CDR</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> GET <span class="s1">'http://{API_HOST}/api/v2/report/1_1_1_5_cb76e372-b798-4a88-9c8a-410740f0300d_0987654321'</span> <span class="se">\ </span>
<span class="nt">--header</span> <span class="s1">'Authorization: 1ebe8f88MzA1MTNkZjMtZjc3My00MTmY'</span>
</code></pre></div>
<blockquote>
<p>Response trả về:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nl">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"code_otp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M43TUI"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-11 11:28:45"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"ended_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-11 11:29:09"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1_1_1_5_cb76e372-b798-4a88-9c8a-410740f0300d_0987654321"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"keypress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">customer_name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Nguyễn Văn A</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">due_amount</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">10.410.000</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">due_days</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">#15</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">template_name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">thong_bao_no_cuoc_1</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0987654321"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-11 11:28:54"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ANSWERED"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TTS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w"> 
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>API dùng để lấy một cdr cụ thể.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET http://{API_HOST}/api/v2/report/{callId}</code></p>
<h3 id='url-parameters-4'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>Call_id trong data trả về</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<p>PBX API sử dụng các mã lỗi sau</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- Your permission is not allow to access environment.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a API with an invalid method.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
